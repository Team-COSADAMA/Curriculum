---

title: 'dplyr ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ê°€ê³µí•˜ê¸°'

slug: 3-2

category: '3. ë°ì´í„° ê°€ê³µ'

---

---

### ğŸ§­ ëª©ì°¨

1. ìƒ˜í”Œ(í–‰)ê³¼ ì†ì„±(ì—´) ì¶”ì¶œ
2. í–‰/ì—´ ë‹¨ìœ„ ì—°ì‚°
3. %>%(íŒŒì´í”„) ì—°ì‚°ìë¥¼ ì´ìš©í•œ ì—°ì† ì²˜ë¦¬

---

ì´ë²ˆ ì¥ì—ì„œëŠ” 'dplyr ë¼ì´ë¸ŒëŸ¬ë¦¬'ì— ëŒ€í•´ ë°°ì›Œë³´ê² ìŠµë‹ˆë‹¤.

**dplyr ë¼ì´ë¸ŒëŸ¬ë¦¬**ëŠ” ë°ì´í„° ê°€ê³µì— íŠ¹í™”ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, R ë°ì´í„° ì „ì²˜ë¦¬ ë° ê°€ê³µì— ê°€ì¥ ë§ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. ë² ì´ìŠ¤ Rê³¼ ë‹¬ë¦¬ `filter()`, `select()` ë“±ì˜ í•¨ìˆ˜ë¥¼ í†µí•´ ë°ì´í„° ê°€ê³µì„ êµ¬í˜„í•˜ì—¬, ì‘ì—… ê³¼ì •ì„ ë³´ë‹¤ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
install.packages('dplyr')   # ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
library(dplyr)              # ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”©

library(gapminder)
```

<br>

### 1) ìƒ˜í”Œ(í–‰)ê³¼ ì†ì„±(ì—´) ì¶”ì¶œ

- `filter(ë°ì´í„°, ì¡°ê±´ì‹)`

  - íŠ¹ì • ìƒ˜í”Œ(í–‰)ì´ ì¶”ì¶œëœë‹¤.

  ```python
  filter(gapminder, continent == 'Asia')
  filter(gapminder, continent == 'Asia' & year > 2000)
  ```

- `select(ë°ì´í„°, ì¶”ì¶œí•  ì—´ ì´ë¦„/ì‹)`

  - íŠ¹ì • ì†ì„±(ì—´)ì´ ì¶”ì¶œëœë‹¤.
  - ë² ì´ìŠ¤ Rê³¼ ë‹¬ë¦¬, ì—´ ì´ë¦„ ì…ë ¥ ì‹œ ë”°ì˜´í‘œê°€ í•„ìš” ì—†ë‹¤.

  ```python
  select(gapminder, country, pop, year)      # dplyr ë¼ì´ë¸ŒëŸ¬ë¦¬
  gapminder[, c('country', 'pop', 'year')]   # ë² ì´ìŠ¤ R
  
  # íŠ¹ì • ì†ì„±(ì—´)ì„ ì œì™¸í•˜ê³  ì‹¶ì€ ê²½ìš°
  select(gapminder, !c(continent, lifeExp, gdpPercap))   # ë²¡í„° ì•ˆì˜ ì—´ ì œì™¸
  ```

<br>

### 2) í–‰/ì—´ ë‹¨ìœ„ì˜ ì—°ì‚°

- `summarise(ë°ì´í„°, ìš”ì•½ í†µê³„í•¨ìˆ˜)`

  ```python
  summarise(gapminder, mean(pop))   # ì¸êµ¬ìˆ˜ í‰ê· 
  
  # ë³€ìˆ˜ì— ì €ì¥í•˜ì—¬ ì¶”í›„ í™œìš©ì´ ê°€ëŠ¥
  summarise(gapminder, pop_mean = mean(pop))   # ë³€ìˆ˜ëª…: pop_mean
  ```

  **ğŸ“– ì°¸ê³ í•˜ê¸°: ìš”ì•½ í†µê³„í•¨ìˆ˜ ì˜ˆì‹œ**

  > |           í•¨ìˆ˜            |      ê¸°ëŠ¥       |
  > | :-----------------------: | :-------------: |
  > |           `n()`           |  ìƒ˜í”Œ(í–‰) ê°œìˆ˜  |
  > | `max(ì†ì„±)` / `min(ì†ì„±)` | ìµœëŒ€ê°’ / ìµœì†Œê°’ |
  > |        `sum(ì†ì„±)`        |      í•©ê³„       |
  > |       `mean(ì†ì„±)`        |      í‰ê·        |
  > |     `quantile(ì†ì„±)`      |     ë¶„ìœ„ìˆ˜      |


<br>

- `group_by(ë°ì´í„°, ì†ì„±)`

  - ë°ì´í„° í”„ë ˆì„ ë‚´ <u>(ë²”ì£¼í˜•)ì†ì„±ì„ í™œìš©</u>í•´, ë°ì´í„°ë¥¼ ê·¸ë£¹ìœ¼ë¡œ ë¶„ë¥˜í•œë‹¤.

  - ë³´í†µ `summarise()`ì™€ í•¨ê»˜ ì‚¬ìš©ëœë‹¤.

  ```python
  # ì „ì²´ ë°ì´í„°ë¥¼ ëŒ€ë¥™ìœ¼ë¡œ ë¶„ë¥˜í•œ ë’¤, ëŒ€ë¥™ë³„ ì¸êµ¬ìˆ˜ í‰ê·  êµ¬í•˜ê¸°
  summarise(group_by(gapminder, continent), pop_mean = mean(pop))
  
  # ë³µìˆ˜ì˜ ì†ì„±ìœ¼ë¡œ ê·¸ë£¹í™”í•  ìˆ˜ ìˆìŒ
  summarise(group_by(gapminder, continent, country), pop_mean = mean(pop))
  ```

<br>

### 3) %>%(íŒŒì´í”„) ì—°ì‚°ìë¥¼ ì´ìš©í•œ ì—°ì† ì²˜ë¦¬

íš¨ìœ¨ì ì¸ ë°ì´í„° ê°€ê³µì„ ìœ„í•´ dplyr ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” ì—°ì‚°ìê°€ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ `%>%`(íŒŒì´í”„) ì—°ì‚°ìì…ë‹ˆë‹¤.

**%>% ì—°ì‚°ì**ëŠ” ì•ì˜ ëª…ë ¹ì–´ ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì „ë‹¬í•˜ì—¬, ì¼ë ¨ì˜ ë°ì´í„° ê°€ê³µ ì‘ì—…ì„ ì—°ê²°í•´ ì¤ë‹ˆë‹¤. 

- **%>% ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°**

  ```python
  summarise(group_by(gapminder, continent, country), pop_mean = mean(pop))
  ```

- **%>% ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°**

  ```python
  gapminder %>% 
      group_by(continent, country) %>%
  	summarise(pop_mean = mean(pop))
  ```

<br>

`iris ë°ì´í„°`ë¡œ í•œ ë²ˆ ë” ë¹„êµí•´ ë´…ì‹œë‹¤.

- **%>% ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°**

  ```python
  tmp1 = filter(iris, Sepal.Length >= 5.5 & Petal.Length >= 3.5)
  tmp2 = select(tmp1, Sepal.Length, Petal.Length, Species)
  tmp3 = summarise(group_by(tmp2, Species),
                   s_avg = mean(Sepal.Length), p_avg = mean(Petal.Length))
  tmp3   # ê²°ê³¼ ì¶œë ¥
  ```

- **%>% ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°**

  ```python
  iris %>%
    filter(Sepal.Length >= 5.5 & Petal.Length >= 3.5) %>%   # í–‰ ì¶”ì¶œ
    select(Sepal.Length, Petal.Length, Species) %>%         # ì—´ ì¶”ì¶œ
    group_by(Species) %>%
    summarise(s_avg = mean(Sepal.Length), p_avg = mean(Petal.Length))
  ```